# LeForge Environment Configuration
# Copy this file to .env and update the values
#
# ===========================================
# ⚠️  PRODUCTION SECURITY CHECKLIST
# ===========================================
# Before deploying to production, ensure you have:
# [ ] Changed POSTGRES_PASSWORD to a strong random value
# [ ] Set REDIS_PASSWORD to a strong random value  
# [ ] Changed LEFORGE_ADMIN_PASSWORD to a secure password
# [ ] Generated and set JWT_SECRET or LEFORGE_JWT_SECRET
# [ ] Configured LEFORGE_SECURE_COOKIES=true (if using HTTPS)
# [ ] Reviewed network exposure (ports 5432, 6379, 1883)
# [ ] Set up SSL/TLS termination (nginx, Cloudflare, etc.)
# [ ] Configured proper firewall rules
# ===========================================

# ===========================================
# General Settings
# ===========================================
NODE_ENV=production
ENVIRONMENT=production
LOG_LEVEL=info
TZ=UTC

# App version (overrides package.json if set)
# APP_VERSION=1.0.0

# Build timestamp (set during CI/CD)
# BUILD_TIME=2026-01-24T00:00:00Z

# ===========================================
# Client Configuration (Vite build-time)
# ===========================================
# Browser-side API base URL (Kong gateway)
# If not set, uses current hostname with port 8000
# VITE_API_BASE_URL=http://localhost:8000

# Override just the port for browser API calls (default: 8000)
# VITE_API_PORT=8000

# ===========================================
# Kong Gateway
# ===========================================
KONG_DATABASE=postgres
KONG_PG_HOST=postgres
KONG_PG_PORT=5432
KONG_PG_USER=kong
KONG_PG_PASSWORD=kong_password_change_me
KONG_PG_DATABASE=kong
KONG_PROXY_LISTEN=0.0.0.0:8000
KONG_ADMIN_LISTEN=0.0.0.0:8001

# ===========================================
# PostgreSQL (Unified Container - Embedded)
# ===========================================
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_USER=leforge
# ⚠️  CHANGE THIS IN PRODUCTION! Generate with: openssl rand -base64 32
POSTGRES_PASSWORD=leforge_dev_password
POSTGRES_DB=leforge

# Kong Database (separate - for multi-container setup)
KONG_POSTGRES_USER=kong
KONG_POSTGRES_PASSWORD=kong_password_change_me
KONG_POSTGRES_DB=kong

# ===========================================
# Redis (Unified Container - Embedded)
# ===========================================
REDIS_HOST=localhost
REDIS_PORT=6379
# ⚠️  SET THIS IN PRODUCTION! Leave empty for development only
# Generate with: openssl rand -base64 32
REDIS_PASSWORD=
REDIS_DB=0

# ===========================================
# Qdrant Vector Database
# ===========================================
QDRANT_HOST=qdrant
QDRANT_PORT=6333
QDRANT_API_KEY=

# ===========================================
# Authentication & Security
# ===========================================
# ⚠️  JWT_SECRET MUST BE SET IN PRODUCTION!
# If not set, a random secret is generated on startup
# Sessions will NOT survive container restarts without this!
# Generate with: openssl rand -hex 64
JWT_SECRET=
LEFORGE_JWT_SECRET=
JWT_EXPIRATION=24h
LEFORGE_JWT_EXPIRES_IN=24h
API_KEY_HEADER=X-API-Key

# Admin credentials
LEFORGE_ADMIN_USER=admin
# ⚠️  CHANGE THIS IN PRODUCTION!
LEFORGE_ADMIN_PASSWORD=admin

# Auth mode: 'local', 'oidc', or 'both'
LEFORGE_AUTH_MODE=local

# Secure cookies - set to 'true' ONLY if using HTTPS
LEFORGE_SECURE_COOKIES=false

# ===========================================
# Service Ports
# ===========================================
CRYPTO_SERVICE_PORT=4001
MATH_SERVICE_PORT=4002
PDF_SERVICE_PORT=4003
OCR_SERVICE_PORT=4004
IMAGE_SERVICE_PORT=4005
LLM_SERVICE_PORT=4006
VECTOR_SERVICE_PORT=4007
DATA_TRANSFORM_SERVICE_PORT=4008
WEB_UI_PORT=3000

# ===========================================
# Service URLs (internal Docker network)
# ===========================================
CRYPTO_SERVICE_URL=http://crypto-service:4001
MATH_SERVICE_URL=http://math-service:4002
PDF_SERVICE_URL=http://pdf-service:4003
OCR_SERVICE_URL=http://ocr-service:4004
IMAGE_SERVICE_URL=http://image-service:4005
LLM_SERVICE_URL=http://llm-service:4006
VECTOR_SERVICE_URL=http://vector-service:4007
DATA_TRANSFORM_SERVICE_URL=http://data-transform-service:4008

# ===========================================
# LLM Service Configuration
# ===========================================
LLM_MODEL_PATH=/models
LLM_DEFAULT_MODEL=
OPENAI_API_KEY=
OPENAI_API_BASE=

# ===========================================
# OCR Service Configuration
# ===========================================
OCR_ENGINE=paddleocr
OCR_LANGUAGES=en,de,fr,es

# ===========================================
# Image Service Configuration
# ===========================================
IMAGE_MAX_SIZE_MB=50
IMAGE_ALLOWED_FORMATS=jpeg,png,webp,gif,tiff,avif

# ===========================================
# PDF Service Configuration
# ===========================================
PDF_MAX_SIZE_MB=100
PDF_TEMP_DIR=/tmp/pdf-processing

# ===========================================
# Rate Limiting
# ===========================================
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS_PER_MINUTE=100
RATE_LIMIT_REQUESTS_PER_HOUR=1000

# ===========================================
# Monitoring & Observability
# ===========================================
METRICS_ENABLED=true
METRICS_PORT=9090
TRACING_ENABLED=false
TRACING_ENDPOINT=

# ===========================================
# CORS Configuration
# ===========================================
CORS_ORIGINS=http://localhost:3000,http://localhost:8000
CORS_METHODS=GET,POST,PUT,DELETE,OPTIONS
CORS_HEADERS=Content-Type,Authorization,X-API-Key,X-Request-ID

# ===========================================
# File Storage
# ===========================================
STORAGE_TYPE=local
STORAGE_PATH=/data/storage
# For S3-compatible storage
S3_ENDPOINT=
S3_ACCESS_KEY=
S3_SECRET_KEY=
S3_BUCKET=
S3_REGION=

# ===========================================
# Email (for notifications)
# ===========================================
SMTP_HOST=
SMTP_PORT=587
SMTP_USER=
SMTP_PASSWORD=
SMTP_FROM=noreply@LeForge.local
